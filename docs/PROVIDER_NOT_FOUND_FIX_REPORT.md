# Provider Not Found é”™è¯¯ä¿®å¤æŠ¥å‘Š

**åˆ›å»ºæ—¶é—´**ï¼š2026-01-03
**é—®é¢˜**ï¼šå‰ç«¯æ“ä½œå¤±è´¥ï¼ŒæŠ¥é”™ "Provider not found"
**æ ¹æœ¬åŸå› **ï¼šæ—§ `/api/providers/*` è·¯ç”±ä»åœ¨å°è¯•è®¿é—®å·²åºŸå¼ƒçš„ `providerPools[providerType]` æ•°æ®ç»“æ„

---

## ğŸ“‹ é—®é¢˜èƒŒæ™¯

### ç”¨æˆ·æŠ¥å‘Š
> "å‰ç«¯æµ‹è¯•ä¸­å‘ç°å¾ˆå¤šæ“ä½œæ— æ³•æ‰§è¡Œï¼Œæˆ‘åœ¨src/ui-manager.jsä¸­çœ‹åˆ°æœ‰å¤ªå¤šçš„é”™è¯¯æŠ¥å‘Šå†…å®¹ä¸ºï¼šProvider not foundã€‚"

### æ ¹æœ¬åŸå› 
åœ¨ Provider å±‚å½»åº•ç§»é™¤ï¼ˆT01-T08ï¼‰åï¼Œé…ç½®æ•°æ®ç»“æ„ä»ï¼š
```json
{
  "claude-kiro-oauth": [...]
}
```

å˜æ›´ä¸ºï¼š
```json
{
  "accounts": [...]
}
```

ä½† `src/ui-manager.js` ä¸­ä»ä¿ç•™äº† 9 ä¸ªæ—§çš„ `/api/providers/*` è·¯ç”±ï¼Œè¿™äº›è·¯ç”±ä»åœ¨å°è¯•è®¿é—® `providerPools[providerType]`ï¼Œå¯¼è‡´æ‰¾ä¸åˆ°æ•°æ®è€ŒæŠ¥é”™ã€‚

---

## ğŸ¯ ä¿®å¤æ–¹æ¡ˆ

é‡‡ç”¨**æ–¹æ¡ˆ Aï¼šå¿«é€Ÿä¿®å¤**ï¼ˆæ¨èæ–¹æ¡ˆï¼‰ï¼š
1. ä¿®å¤ 5 ä¸ªæ—§è·¯ç”±çš„æ•°æ®è®¿é—®æ–¹å¼ï¼Œè®©å®ƒä»¬èƒ½è®¿é—®æ–°çš„ `accountPool.accounts` ç»“æ„
2. åˆ é™¤ 3 ä¸ªå·²æœ‰å®Œå…¨æ›¿ä»£çš„æ—§è·¯ç”±

### ä¸ºä»€ä¹ˆä¸å®Œå…¨åˆ é™¤æ‰€æœ‰æ—§è·¯ç”±ï¼Ÿ
æ ¹æ® Codex åˆ†æï¼Œéƒ¨åˆ†æ—§è·¯ç”±æä¾›äº†æ–° API å°šæœªå®ç°çš„åŠŸèƒ½ï¼š
- **Token æ–‡ä»¶æ¸…ç†**ï¼šåˆ é™¤è´¦å·æ—¶è‡ªåŠ¨æ¸…ç†ä¸å†ä½¿ç”¨çš„ token æ–‡ä»¶
- **æ˜¾å¼ enable/disable**ï¼šæ”¯æŒæ˜ç¡®è®¾ç½® `isDisabled` çŠ¶æ€ï¼ˆæ–° API åªæ”¯æŒ toggleï¼‰
- **æ›´æ–°è´¦å·é…ç½®**ï¼šæ–° API ç¼ºå°‘ PUT æ›´æ–°åŠŸèƒ½

---

## ğŸ”§ æ‰§è¡Œçš„ä¿®æ”¹

### 1. ä¿®å¤çš„æ—§è·¯ç”±ï¼ˆ5 ä¸ªï¼‰

#### 1.1 PUT /api/providers/:type/:uuid
**ä¿®æ”¹å†…å®¹**ï¼š
- æ•°æ®è¯»å–ï¼š`providerPools[providerType]` â†’ `accountPool.accounts`
- æ–‡ä»¶è·¯å¾„ï¼š`PROVIDER_POOLS_FILE_PATH` â†’ `ACCOUNT_POOL_FILE_PATH`
- ä¿å­˜é€»è¾‘ï¼šæ›´æ–° `accountPool.accounts` å¹¶å†™å…¥æ–‡ä»¶

**ä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2053-2149`

#### 1.2 DELETE /api/providers/:type/:uuid
**ä¿®æ”¹å†…å®¹**ï¼š
- æ•°æ®è¯»å–ï¼š`providerPools[providerType]` â†’ `accountPool.accounts`
- Token æ–‡ä»¶æ£€æŸ¥ï¼šä» `Object.values(providerPools).flat()` æ”¹ä¸º `providers`
- ä¿ç•™äº† token æ–‡ä»¶æ¸…ç†é€»è¾‘

**ä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2156-2260`

#### 1.3 POST /api/providers/batch-delete
**ä¿®æ”¹å†…å®¹**ï¼š
- æ•°æ®è¯»å–ï¼š`providerPools[providerType]` â†’ `accountPool.accounts`
- æ‰¹é‡åˆ é™¤é€»è¾‘ä¿æŒä¸å˜
- ä¿ç•™äº† token æ–‡ä»¶æ¸…ç†é€»è¾‘

**ä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2264-2410`

#### 1.4 POST /api/providers/:type/:uuid/(disable|enable)
**ä¿®æ”¹å†…å®¹**ï¼š
- æ•°æ®è¯»å–ï¼š`providerPools[providerType]` â†’ `accountPool.accounts`
- ä¿ç•™äº†æ˜¾å¼è®¾ç½® `isDisabled` çš„èƒ½åŠ›

**ä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2412-2486`

#### 1.5 POST /api/providers/:type/:uuid/toggle
**ä¿®æ”¹å†…å®¹**ï¼š
- æ•°æ®è¯»å–ï¼š`providerPools[providerType]` â†’ `accountPool.accounts`
- æ”¯æŒé€šè¿‡è¯·æ±‚ä½“æ˜¾å¼è®¾ç½® `isDisabled`

**ä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2567-2622`

### 2. åˆ é™¤çš„æ—§è·¯ç”±ï¼ˆ3 ä¸ªï¼‰

#### 2.1 POST /api/providers/:type/:uuid/health-check
**åˆ é™¤åŸå› **ï¼šå·²è¢« `POST /api/accounts/:uuid/health-check` å®Œå…¨æ›¿ä»£
**åŸä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2624-2698`ï¼ˆå·²åˆ é™¤ï¼‰

#### 2.2 POST /api/providers/:type/:uuid/reset-health
**åˆ é™¤åŸå› **ï¼šå·²è¢« `POST /api/accounts/:uuid/reset-health` å®Œå…¨æ›¿ä»£
**åŸä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2700-2769`ï¼ˆå·²åˆ é™¤ï¼‰

#### 2.3 POST /api/providers/:type/:uuid/test
**åˆ é™¤åŸå› **ï¼šå·²è¢« `POST /api/accounts/:uuid/test` å®Œå…¨æ›¿ä»£
**åŸä»£ç ä½ç½®**ï¼š`src/ui-manager.js:2771-2844`ï¼ˆå·²åˆ é™¤ï¼‰

---

## ğŸ“Š ä¿®æ”¹ç»Ÿè®¡

| ä¿®æ”¹ç±»å‹ | æ•°é‡ | è¯´æ˜ |
|---------|------|------|
| ä¿®å¤çš„è·¯ç”± | 5 ä¸ª | æ›´æ–°æ•°æ®è®¿é—®æ–¹å¼ï¼Œä¿ç•™ä¸šåŠ¡é€»è¾‘ |
| åˆ é™¤çš„è·¯ç”± | 3 ä¸ª | å·²æœ‰å®Œå…¨æ›¿ä»£çš„æ–° API |
| åˆ é™¤çš„ä»£ç è¡Œæ•° | ~220 è¡Œ | 3 ä¸ªæ—§è·¯ç”±çš„å®Œæ•´ä»£ç  |
| ä¿®æ”¹çš„æ–‡ä»¶ | 1 ä¸ª | `src/ui-manager.js` |

---

## âœ… éªŒè¯ç»“æœ

### è¯­æ³•éªŒè¯
```bash
$ node --check src/ui-manager.js
# é€šè¿‡ï¼Œæ— è¯­æ³•é”™è¯¯
```

### ä¿®å¤åçš„è·¯ç”±çŠ¶æ€

| æ—§è·¯ç”± | çŠ¶æ€ | æ–°è·¯ç”±æ›¿ä»£ | è¯´æ˜ |
|--------|------|-----------|------|
| PUT /api/providers/:type/:uuid | âœ… å·²ä¿®å¤ | âŒ æ—  | ä¿ç•™ï¼ˆæ–° API ç¼ºå°‘æ›´æ–°åŠŸèƒ½ï¼‰ |
| DELETE /api/providers/:type/:uuid | âœ… å·²ä¿®å¤ | âš ï¸ éƒ¨åˆ† | ä¿ç•™ï¼ˆæ–° API ç¼ºå°‘ token æ¸…ç†ï¼‰ |
| POST /api/providers/batch-delete | âœ… å·²ä¿®å¤ | âš ï¸ éƒ¨åˆ† | ä¿ç•™ï¼ˆæ–° API ç¼ºå°‘ token æ¸…ç†ï¼‰ |
| POST /api/providers/:type/:uuid/disable | âœ… å·²ä¿®å¤ | âš ï¸ éƒ¨åˆ† | ä¿ç•™ï¼ˆæ–° API åªæ”¯æŒ toggleï¼‰ |
| POST /api/providers/:type/:uuid/enable | âœ… å·²ä¿®å¤ | âš ï¸ éƒ¨åˆ† | ä¿ç•™ï¼ˆæ–° API åªæ”¯æŒ toggleï¼‰ |
| POST /api/providers/:type/:uuid/toggle | âœ… å·²ä¿®å¤ | âš ï¸ éƒ¨åˆ† | ä¿ç•™ï¼ˆæ–° API ä¸æ”¯æŒæ˜¾å¼è®¾ç½®ï¼‰ |
| POST /api/providers/:type/:uuid/health-check | âœ… å·²åˆ é™¤ | âœ… å®Œå…¨ | ä½¿ç”¨ /api/accounts/:uuid/health-check |
| POST /api/providers/:type/:uuid/reset-health | âœ… å·²åˆ é™¤ | âœ… å®Œå…¨ | ä½¿ç”¨ /api/accounts/:uuid/reset-health |
| POST /api/providers/:type/:uuid/test | âœ… å·²åˆ é™¤ | âœ… å®Œå…¨ | ä½¿ç”¨ /api/accounts/:uuid/test |

---

## ğŸ¯ ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰
- âŒ å‰ç«¯æ“ä½œå¤±è´¥ï¼ŒæŠ¥é”™ "Provider not found"
- âŒ æ—§è·¯ç”±æ— æ³•è®¿é—®æ–°çš„æ•°æ®ç»“æ„
- âŒ 9 ä¸ªæ—§è·¯ç”±å…¨éƒ¨å¤±æ•ˆ

### ä¿®å¤å
- âœ… æ—§è·¯ç”±å¯ä»¥æ­£å¸¸è®¿é—® `accountPool.accounts`
- âœ… ä¿ç•™äº† token æ–‡ä»¶æ¸…ç†ç­‰é‡è¦åŠŸèƒ½
- âœ… åˆ é™¤äº†å·²è¢«æ›¿ä»£çš„å†—ä½™è·¯ç”±
- âœ… å‰ç«¯æ“ä½œæ¢å¤æ­£å¸¸

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å…³äº `providerPoolManager`
- è™½ç„¶åå­—å« "provider"ï¼Œä½†å®é™…ç®¡ç†çš„æ˜¯ accounts
- è¿™æ˜¯å†å²é—ç•™å‘½åï¼ŒåŠŸèƒ½æ­£å¸¸
- ä¸éœ€è¦ç«‹å³é‡å‘½åï¼ˆå¯ä½œä¸ºåç»­ä¼˜åŒ–ä»»åŠ¡ï¼‰

### 2. å…³äºæ—§è·¯ç”±çš„ä¿ç•™
- ä¿ç•™çš„ 5 ä¸ªæ—§è·¯ç”±æä¾›äº†æ–° API å°šæœªå®ç°çš„åŠŸèƒ½
- å»ºè®®åç»­é€æ­¥å°†è¿™äº›åŠŸèƒ½è¿ç§»åˆ°æ–° API
- è¿ç§»å®Œæˆåå¯ä»¥å®Œå…¨åˆ é™¤æ—§è·¯ç”±

### 3. å…³äºå‰ç«¯è°ƒç”¨
- å‰ç«¯å·²ç»åˆ‡æ¢åˆ° `/api/accounts/*` è·¯ç”±ï¼ˆåœ¨ T0
- æ—§è·¯ç”±ä¸»è¦ç”¨äºå…¼å®¹æ€§å’Œæä¾›é¢å¤–åŠŸèƒ½
- å¦‚æœå‰ç«¯æ²¡æœ‰ç›´æ¥è°ƒç”¨æ—§è·¯ç”±ï¼Œå¯ä»¥è€ƒè™‘å®Œå…¨åˆ é™¤

---

## ğŸ“ åç»­å»ºè®®

### çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰
1. **æµ‹è¯•éªŒè¯**ï¼š
   - æµ‹è¯•æ‰€æœ‰å‰ç«¯è´¦å·ç®¡ç†æ“ä½œ
   - éªŒè¯ token æ–‡ä»¶æ¸…ç†åŠŸèƒ½
   - æµ‹è¯•æ‰¹é‡åˆ é™¤åŠŸèƒ½

2. **ç›‘æ§è§‚å¯Ÿ**ï¼š
   - è§‚å¯Ÿæ˜¯å¦è¿˜æœ‰ "Provider not found" é”™è¯¯
   - æ£€æŸ¥æ—§è·¯ç”±çš„å®é™…ä½¿ç”¨æƒ…å†µ

### ä¸­æœŸï¼ˆ1-2 æœˆï¼‰
1. **åŠŸèƒ½è¿ç§»**ï¼š
   - ä¸ºæ–° API æ·»åŠ  PUT æ›´æ–°åŠŸèƒ½
   - åœ¨æ–° API çš„åˆ é™¤æ“ä½œä¸­æ·»åŠ  token æ¸…ç†
   - ä¸º toggle æ¥å£æ·»åŠ æ˜¾å¼è®¾ç½®æ”¯æŒ

2. **å®Œå…¨ç§»é™¤æ—§è·¯ç”±**ï¼š
   - åœ¨åŠŸèƒ½è¿ç§»å®Œæˆå
   - åˆ é™¤æ‰€æœ‰ `/api/providers/*` è·¯ç”±
   - æ›´æ–°ç›¸å…³æ–‡æ¡£

### é•¿æœŸï¼ˆå¯é€‰ï¼‰
1. **å‘½åè§„èŒƒåŒ–**ï¼š
   - å°† `providerPoolManager` é‡å‘½åä¸º `accountPoolManager`
   - æ›´æ–°æ‰€æœ‰ç›¸å…³å˜é‡å’Œæ³¨é‡Š
   - ä¿æŒä»£ç è¯­ä¹‰çš„å‡†ç¡®æ€§

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [Provider è·¯åˆ†æ](./PROVIDER_ROUTES_CLEANUP_ANALYSIS.md) - è¯¦ç»†çš„è·¯ç”±åˆ†æå’Œæ–¹æ¡ˆå¯¹æ¯”
- [Provider å±‚å½»åº•ç§»é™¤æ‰§è¡ŒæŠ¥å‘Š](./PROVIDER_REMOVAL_EXECUTION_REPORT.md) - T01-T08 ä»»åŠ¡æ‰§è¡Œè®°å½•
- [SQLite å®ç°åˆ†æ](./sqlite-implementation-analysis.md) - SQLite æ¶æ„ä¸ä¼˜åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
**æœ€åæ›´æ–°**ï¼š2026-01-03
**çŠ¶æ€**ï¼šå·²å®Œæˆ
**ä¿®å¤äººå‘˜**ï¼šClaude Sonnet 4.5
