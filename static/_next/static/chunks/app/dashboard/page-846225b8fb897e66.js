(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{3557:function(e,t,s){Promise.resolve().then(s.bind(s,141))},141:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var a=s(7437),r=s(2265),l=s(3243);let i=(0,l.Z)("outline","rocket","Rocket",[["path",{d:"M4 13a8 8 0 0 1 7 7a6 6 0 0 0 3 -5a9 9 0 0 0 6 -8a3 3 0 0 0 -3 -3a9 9 0 0 0 -8 6a6 6 0 0 0 -5 3",key:"svg-0"}],["path",{d:"M7 14a6 6 0 0 0 -3 6a6 6 0 0 0 6 -3",key:"svg-1"}],["path",{d:"M15 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]);var n=s(1843),d=s(6695),o=s(7564),c=s(3546),u=s(1695);let x=(0,l.Z)("outline","cpu","Cpu",[["path",{d:"M5 5m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M9 9h6v6h-6z",key:"svg-1"}],["path",{d:"M3 10h2",key:"svg-2"}],["path",{d:"M3 14h2",key:"svg-3"}],["path",{d:"M10 3v2",key:"svg-4"}],["path",{d:"M14 3v2",key:"svg-5"}],["path",{d:"M21 10h-2",key:"svg-6"}],["path",{d:"M21 14h-2",key:"svg-7"}],["path",{d:"M14 21v-2",key:"svg-8"}],["path",{d:"M10 21v-2",key:"svg-9"}]]);var h=s(4746),m=s(3022),g=s(1343);let p=async(e,t)=>{try{var s;let t=await e.clone().json();if(null==t?void 0:null===(s=t.error)||void 0===s?void 0:s.message)return t.error.message;if(null==t?void 0:t.message)return t.message}catch(e){}return t},f=e=>{let{icon:t,title:s,value:r,subtitle:l,gradient:i,loading:n=!1}=e;return(0,a.jsxs)("div",{className:"group relative bg-gradient-to-br from-white/[0.05] to-white/[0.02] rounded-2xl border border-white/10 p-5 hover:border-white/20 transition-all duration-300 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute -right-4 -top-4 w-24 h-24 rounded-full bg-gradient-to-br ".concat(i," opacity-10 blur-2xl group-hover:opacity-20 transition-opacity")}),(0,a.jsxs)("div",{className:"relative flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2",children:s}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-white mb-1",children:n?(0,a.jsx)("span",{className:"animate-pulse",children:"--"}):r}),l&&(0,a.jsx)("p",{className:"text-xs text-gray-600",children:l})]}),(0,a.jsx)("div",{className:"p-2.5 rounded-xl bg-gradient-to-br ".concat(i),children:(0,a.jsx)(t,{className:"w-5 h-5 text-white"})})]})]})},v=e=>{let{title:t,path:s,description:r,recommended:l=!1,gradient:i}=e;return(0,a.jsxs)("div",{className:"group relative bg-gradient-to-br from-white/[0.05] to-white/[0.02] rounded-xl border border-white/10 p-4 hover:border-white/20 transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-gradient-to-r ".concat(i)}),(0,a.jsx)("h3",{className:"text-sm font-semibold text-white",children:t})]}),l&&(0,a.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",children:"推荐"})]}),(0,a.jsx)("div",{className:"bg-black/40 rounded-lg p-3 border border-white/5 mb-2 overflow-x-auto",children:(0,a.jsxs)("code",{className:"text-xs font-mono",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"POST"}),(0,a.jsx)("span",{className:"ml-2 bg-gradient-to-r ".concat(i," bg-clip-text text-transparent"),children:s})]})}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:r})]})};function j(){let[e,t]=(0,r.useState)(null),[s,l]=(0,r.useState)(null),[j,b]=(0,r.useState)(null),[w,N]=(0,r.useState)(!0),[y,k]=(0,r.useState)(!1),M=(0,r.useMemo)(()=>(function(){let e=new Date().getHours();return e<6?"夜深了":e<12?"早上好":e<14?"中午好":e<18?"下午好":"晚上好"})(),[]);(0,r.useEffect)(()=>{Z()},[]);let Z=async()=>{k(!0);try{let[e,s,a]=await Promise.all([(0,g.ri)("/api/system"),(0,g.ri)("/api/accounts"),(0,g.ri)("/api/usage")]);if(!e.ok){let t=await p(e,"获取系统信息失败");throw Error(t)}if(!s.ok){let e=await p(s,"获取提账号信息失败");throw Error(e)}if(!a.ok){let e=await p(a,"获取用量数据失败");throw Error(e)}t(await e.json());let r=await s.json();r._accountPoolStats&&l(r._accountPoolStats);let i=await a.json();b(U(i))}catch(e){if((0,g.TW)(e))return;console.error("Failed to fetch data:",e)}finally{N(!1),k(!1)}},U=e=>{let t=0,s=0,a=0,r=0,l=0;if(null==e?void 0:e.providers){for(let n of Object.values(e.providers))if(n.instances)for(let e of n.instances){var i;r++,e.isHealthy&&a++,(null===(i=e.limits)||void 0===i?void 0:i.total)&&(l++,t+=e.limits.total||0,s+=e.limits.used||0)}}return{totalQuota:t,usedQuota:s,remainingQuota:t-s,percentUsed:t>0?s/t*100:0,healthyAccounts:a,totalAccounts:r,accountsWithQuota:l}};return w?(0,a.jsx)(m.y6,{}):(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-blue-500/20 to-purple-500/20 border border-blue-500/30",children:(0,a.jsx)(i,{className:"w-6 h-6 text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:M}),(0,a.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-white to-gray-400 bg-clip-text text-transparent",children:"欢迎回来"})]})]}),(0,a.jsxs)("button",{onClick:Z,disabled:y,className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium bg-white/5 border border-white/10 hover:bg-white/10 transition-all disabled:opacity-50",children:[y?(0,a.jsx)(n.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(d.Z,{className:"w-4 h-4"}),y?"刷新中...":"刷新"]})]}),j&&j.accountsWithQuota>0&&(0,a.jsx)("div",{className:"bg-gradient-to-br from-white/[0.05] to-white/[0.02] rounded-2xl border border-white/10 p-5 overflow-hidden",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"p-2 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600",children:(0,a.jsx)(o.Z,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-semibold text-white",children:"额度概览"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[j.accountsWithQuota," 个账号"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"已使用"}),(0,a.jsxs)("span",{className:"font-medium",children:[(0,a.jsx)("span",{className:j.percentUsed>80?"text-red-400":j.percentUsed>50?"text-amber-400":"text-emerald-400",children:j.usedQuota.toFixed(1)}),(0,a.jsxs)("span",{className:"text-gray-600",children:[" / ",j.totalQuota.toFixed(1)]})]})]}),(0,a.jsx)("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full transition-all duration-700 ".concat(j.percentUsed>80?"bg-gradient-to-r from-red-500 to-pink-500":j.percentUsed>50?"bg-gradient-to-r from-amber-500 to-orange-500":"bg-gradient-to-r from-emerald-500 to-teal-500"),style:{width:"".concat(Math.min(j.percentUsed,100),"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,a.jsxs)("span",{children:[j.percentUsed.toFixed(1),"%"]}),(0,a.jsxs)("span",{children:["剩余 ",j.remainingQuota.toFixed(1)]})]})]})]}),s&&(0,a.jsxs)("div",{className:"lg:w-72 lg:border-l lg:border-white/10 lg:pl-6",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-3",children:"账号池"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,a.jsxs)("div",{className:"text-center p-2.5 rounded-lg bg-emerald-500/10 border border-emerald-500/20",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-emerald-400",children:s.healthy}),(0,a.jsx)("div",{className:"text-[10px] text-gray-500",children:"健康"})]}),(0,a.jsxs)("div",{className:"text-center p-2.5 rounded-lg bg-amber-500/10 border border-amber-500/20",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-amber-400",children:s.checking}),(0,a.jsx)("div",{className:"text-[10px] text-gray-500",children:"检查"})]}),(0,a.jsxs)("div",{className:"text-center p-2.5 rounded-lg bg-red-500/10 border border-red-500/20",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-red-400",children:s.banned}),(0,a.jsx)("div",{className:"text-[10px] text-gray-500",children:"异常"})]})]}),(0,a.jsxs)("div",{className:"mt-2 flex justify-between text-[10px] text-gray-600",children:[(0,a.jsxs)("span",{children:["请求: ",s.totalUsageCount]}),(0,a.jsxs)("span",{children:["缓存: ",s.cacheHitRate]})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(f,{icon:c.Z,title:"运行时间",value:(null==e?void 0:e.uptime)?function(e){let t="string"==typeof e?parseFloat(e):e;if(isNaN(t))return"--";let s=Math.floor(t/86400),a=Math.floor(t%86400/3600),r=Math.floor(t%3600/60);return s>0?"".concat(s,"天 ").concat(a,"时"):a>0?"".concat(a,"时 ").concat(r,"分"):"".concat(r,"分钟")}(e.uptime):"--",gradient:"from-amber-500 to-orange-500",loading:w}),(0,a.jsx)(f,{icon:u.Z,title:"服务器时间",value:(null==e?void 0:e.serverTime)?new Date(e.serverTime).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):"--",gradient:"from-blue-500 to-cyan-500",loading:w}),(0,a.jsx)(f,{icon:x,title:"Node 版本",value:(null==e?void 0:e.nodeVersion)||"--",gradient:"from-emerald-500 to-teal-500",loading:w}),(0,a.jsx)(f,{icon:h.Z,title:"内存使用",value:(null==e?void 0:e.memoryUsage)||"--",gradient:"from-purple-500 to-pink-500",loading:w})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-3",children:"API 端点"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsx)(v,{title:"OpenAI 协议",path:"/claude-kiro-oauth/v1/chat/completions",description:"兼容 OpenAI SDK，支持流式输出",recommended:!0,gradient:"from-emerald-500 to-teal-500"}),(0,a.jsx)(v,{title:"Claude 协议",path:"/claude-kiro-oauth/v1/messages",description:"原生 Claude API 格式",gradient:"from-blue-500 to-indigo-500"})]})]})]})}},3022:function(e,t,s){"use strict";s.d(t,{y6:function(){return d}});var a=s(7437),r=s(4508);function l(e){let{className:t}=e;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-lg bg-white/5",t)})}function i(){return(0,a.jsx)("div",{className:"p-6 rounded-xl bg-white/[0.02] border border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(l,{className:"w-12 h-12 rounded-lg"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(l,{className:"h-4 w-24"}),(0,a.jsx)(l,{className:"h-6 w-16"})]})]})})}function n(){return(0,a.jsx)("div",{className:"p-4 rounded-xl bg-white/[0.02] border border-white/10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,a.jsx)(l,{className:"w-10 h-10 rounded-lg"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(l,{className:"h-4 w-32"}),(0,a.jsx)(l,{className:"h-3 w-48"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l,{className:"w-16 h-8 rounded-lg"}),(0,a.jsx)(l,{className:"w-16 h-8 rounded-lg"})]})]})})}function d(){return(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l,{className:"h-8 w-48"}),(0,a.jsx)(l,{className:"h-4 w-64"})]}),(0,a.jsx)(l,{className:"h-12 w-32 rounded-lg"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(i,{},t))}),(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(n,{},t))})]})}},1343:function(e,t,s){"use strict";s.d(t,{TW:function(){return o},gD:function(){return i},ri:function(){return c}});class a extends Error{constructor(e="Unauthorized"){super(e),this.name="UnauthorizedError",Object.setPrototypeOf(this,a.prototype)}}let r=null,l=null;function i(e){return r=e,()=>{r===e&&(r=null)}}async function n(e){if(!function(e){let t=e.headers.get("content-type");return null!==t&&t.toLowerCase().includes("application/json")}(e))return null;try{return await e.clone().json()}catch(e){return null}}async function d(){if(null!==l){await l;return}l=(async()=>{try{localStorage.removeItem("authToken"),null!==r&&await Promise.resolve(r()),window.location.replace("/login.html")}catch(e){console.error("Error during unauthorized flow:",e),window.location.replace("/login.html")}})().finally(()=>{l=null}),await l}function o(e){return e instanceof a}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=new Headers(t.headers),r=localStorage.getItem("authToken");null===r||s.has("Authorization")||s.set("Authorization","Bearer ".concat(r));let l=await fetch(e,{...t,headers:s});if(401===l.status)throw await d(),new a("HTTP 401 Unauthorized");let i=await n(l);if(i&&"UNAUTHORIZED"===i.code)throw await d(),new a("API returned UNAUTHORIZED code");return l}},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return l}});var a=s(1994),r=s(3335);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}},3546:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(3243).Z)("outline","bolt","Bolt",[["path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11",key:"svg-0"}]])},4746:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(3243).Z)("outline","chart-line","ChartLine",[["path",{d:"M4 19l16 0",key:"svg-0"}],["path",{d:"M4 15l4 -6l4 2l4 -5l4 4",key:"svg-1"}]])},1695:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(3243).Z)("outline","clock","Clock",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 7v5l3 3",key:"svg-1"}]])},7564:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(3243).Z)("outline","trending-up","TrendingUp",[["path",{d:"M3 17l6 -6l4 4l8 -8",key:"svg-0"}],["path",{d:"M14 7l7 0l0 7",key:"svg-1"}]])}},function(e){e.O(0,[582,971,117,744],function(){return e(e.s=3557)}),_N_E=e.O()}]);