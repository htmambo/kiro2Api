(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[606],{1986:function(e,s,t){Promise.resolve().then(t.bind(t,4641))},4641:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var a=t(7437),l=t(2265),r=t(2877),n=t(3243);let i=(0,n.Z)("outline","lock","Lock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]);var c=t(5783),d=t(9810),o=t(1843),h=t(6695),x=t(6393),m=t(1443);let u=(0,n.Z)("outline","search","Search",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]);var g=t(9740),p=t(2596),f=t(4810),v=t(5974),j=t(3149),y=t(3022),N=t(1343);let b=async(e,s)=>{try{var t;let s=await e.clone().json();if(null==s?void 0:null===(t=s.error)||void 0===t?void 0:t.message)return s.error.message;if(null==s?void 0:s.message)return s.message}catch(e){}return s};function w(){let e=(0,j.p)(),[s,t]=(0,l.useState)([]),[n,w]=(0,l.useState)([]),[k,Z]=(0,l.useState)(!0),[M,C]=(0,l.useState)(!1),[E,S]=(0,l.useState)(""),[z,J]=(0,l.useState)("all"),[F,L]=(0,l.useState)(null),[T,B]=(0,l.useState)(""),[U,_]=(0,l.useState)(!1);(0,l.useEffect)(()=>{O()},[]),(0,l.useEffect)(()=>{D()},[s,E,z]);let O=async()=>{C(!0);let s=Date.now();try{let e=await (0,N.ri)("/api/upload-configs");if(!e.ok){let s=await b(e,"加载凭据失败");throw Error(s)}let s=await e.json();t(s)}catch(s){if((0,N.TW)(s))return;console.error("Failed to load credentials:",s),e.error("加载凭据失败",s instanceof Error?s.message:void 0)}finally{let e=Date.now()-s;e<800&&await new Promise(s=>setTimeout(s,800-e)),Z(!1),C(!1)}},D=()=>{let e=s;E&&(e=e.filter(e=>e.name.toLowerCase().includes(E.toLowerCase())||e.path.toLowerCase().includes(E.toLowerCase()))),"all"!==z&&(e=e.filter(e=>"used"===z?e.isUsed:!e.isUsed)),w(e)},P=async s=>{try{let e=await (0,N.ri)("/api/upload-configs/view/".concat(encodeURIComponent(s.path)));if(!e.ok){let s=await b(e,"加载失败");throw Error(s)}let t=await e.json();B(t.content||JSON.stringify(t,null,2)),L(s),_(!0)}catch(s){if((0,N.TW)(s))return;console.error("Failed to load file content:",s),e.error("加载失败",s instanceof Error?s.message:"加载文件内容失败")}},W=async s=>{if(confirm("确定要删除此文件吗？此操作不可撤销。"))try{let t=await (0,N.ri)("/api/upload-configs/delete/".concat(encodeURIComponent(s)),{method:"DELETE"});if(!t.ok){let e=await b(t,"删除失败");throw Error(e)}await O(),e.success("删除成功","文件已删除")}catch(s){if((0,N.TW)(s))return;console.error("Failed to delete file:",s),e.error("删除失败",s instanceof Error?s.message:void 0)}},A=e=>e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(2)," KB"):"".concat((e/1048576).toFixed(2)," MB"),I=e=>new Date(e).toLocaleString("zh-CN"),K=e=>{switch(e){case"oauth":return(0,a.jsx)(r.Z,{className:"w-5 h-5 text-blue-400"});case"api-key":return(0,a.jsx)(i,{className:"w-5 h-5 text-green-400"});case"system-prompt":return(0,a.jsx)(c.Z,{className:"w-5 h-5 text-purple-400"});default:return(0,a.jsx)(d.Z,{className:"w-5 h-5 text-gray-400"})}},R=s.length,q=s.filter(e=>e.isUsed).length,G=s.reduce((e,s)=>e+s.size,0);return k?(0,a.jsx)(y.y6,{}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between animate-fade-in-up",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"凭据文件管理"}),(0,a.jsx)("p",{className:"text-gray-400",children:"管理 OAuth 凭据和配置文件"})]}),(0,a.jsxs)("button",{onClick:O,disabled:M,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-lg font-semibold transition-all duration-200 hover:shadow-lg hover:shadow-purple-500/50 disabled:opacity-50",children:[M?(0,a.jsx)(o.Z,{className:"w-5 h-5 animate-spin"}):(0,a.jsx)(h.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:M?"刷新中...":"刷新列表"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"animate-scale-in delay-100",children:(0,a.jsx)(f.J,{children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"总文件数"}),(0,a.jsx)("h3",{className:"text-2xl font-bold",children:R})]})]})})}),(0,a.jsx)("div",{className:"animate-scale-in delay-200",children:(0,a.jsx)(f.J,{children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-green-500 to-emerald-600 flex items-center justify-center",children:(0,a.jsx)(x.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"已使用"}),(0,a.jsx)("h3",{className:"text-2xl font-bold",children:q})]})]})})}),(0,a.jsx)("div",{className:"animate-scale-in delay-300",children:(0,a.jsx)(f.J,{children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-orange-500 to-red-600 flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"未使用"}),(0,a.jsx)("h3",{className:"text-2xl font-bold",children:R-q})]})]})})}),(0,a.jsx)("div",{className:"animate-scale-in delay-400",children:(0,a.jsx)(f.J,{children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-pink-500 to-purple-600 flex items-center justify-center",children:(0,a.jsx)(d.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"总大小"}),(0,a.jsx)("h3",{className:"text-2xl font-bold",children:A(G)})]})]})})})]}),(0,a.jsx)(f.J,{children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(u,{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:E,onChange:e=>S(e.target.value),placeholder:"搜索文件名或路径...",className:"w-full pl-10 pr-4 py-2 bg-white/5 border border-white/10 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>J("all"),className:"px-4 py-2 rounded-lg transition-all ".concat("all"===z?"bg-blue-500 text-white":"bg-white/5 hover:bg-white/10"),children:"全部"}),(0,a.jsx)("button",{onClick:()=>J("used"),className:"px-4 py-2 rounded-lg transition-all ".concat("used"===z?"bg-green-500 text-white":"bg-white/5 hover:bg-white/10"),children:"已使用"}),(0,a.jsx)("button",{onClick:()=>J("unused"),className:"px-4 py-2 rounded-lg transition-all ".concat("unused"===z?"bg-orange-500 text-white":"bg-white/5 hover:bg-white/10"),children:"未使用"})]})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:0===n.length?(0,a.jsx)(f.J,{children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-400 text-lg",children:"暂无凭据文件"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"请上传 OAuth 凭据文件"})]})}):n.map(e=>(0,a.jsx)(f.J,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[K(e.type),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),e.isUsed?(0,a.jsxs)(v.C,{variant:"default",className:"bg-green-500",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3 mr-1"}),"已使用"]}):(0,a.jsx)(v.C,{variant:"outline",children:"未使用"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-400 truncate max-w-lg",title:e.path,children:e.path}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500 mt-1",children:[(0,a.jsx)("span",{children:A(e.size)}),(0,a.jsx)("span",{children:I(e.modified)}),e.usedBy&&e.usedBy.length>0&&(0,a.jsxs)("span",{className:"text-blue-400",children:["关联: ",e.usedBy.join(", ")]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>P(e),className:"px-3 py-1.5 text-sm rounded-lg border border-white/10 hover:bg-white/5 transition-colors flex items-center gap-1",children:[(0,a.jsx)(g.Z,{className:"w-4 h-4"}),"查看"]}),(0,a.jsxs)("button",{onClick:()=>W(e.path),className:"px-3 py-1.5 text-sm rounded-lg border border-red-500/50 text-red-400 hover:bg-red-500/10 transition-colors flex items-center gap-1",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),"删除"]})]})]})},e.path))}),U&&F&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>_(!1),children:(0,a.jsxs)("div",{className:"bg-gray-900 rounded-xl border border-white/10 max-w-4xl w-full max-h-[80vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"p-6 border-b border-white/10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:F.name}),(0,a.jsx)("button",{onClick:()=>_(!1),className:"px-4 py-2 rounded-lg border border-white/10 hover:bg-white/5 transition-colors",children:"关闭"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:F.path})]}),(0,a.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:(0,a.jsx)("pre",{className:"bg-black/50 p-4 rounded-lg border border-white/10 overflow-x-auto",children:(0,a.jsx)("code",{className:"text-sm text-green-400 font-mono",children:T})})})]})})]})}},9740:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3243).Z)("outline","eye","Eye",[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]])},9810:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3243).Z)("outline","file","File",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}]])},5783:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3243).Z)("outline","file-text","FileText",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M9 9l1 0",key:"svg-2"}],["path",{d:"M9 13l6 0",key:"svg-3"}],["path",{d:"M9 17l6 0",key:"svg-4"}]])},2877:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3243).Z)("outline","key","Key",[["path",{d:"M16.555 3.843l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.643 2.643a2.877 2.877 0 0 1 -4.069 0l-.301 -.301l-6.558 6.558a2 2 0 0 1 -1.239 .578l-.175 .008h-1.172a1 1 0 0 1 -.993 -.883l-.007 -.117v-1.172a2 2 0 0 1 .467 -1.284l.119 -.13l.414 -.414h2v-2h2v-2l2.144 -2.144l-.301 -.301a2.877 2.877 0 0 1 0 -4.069l2.643 -2.643a2.877 2.877 0 0 1 4.069 0z",key:"svg-0"}],["path",{d:"M15 9h.01",key:"svg-1"}]])},2596:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(3243).Z)("outline","trash","Trash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]])}},function(e){e.O(0,[582,29,976,971,117,744],function(){return e(e.s=1986)}),_N_E=e.O()}]);